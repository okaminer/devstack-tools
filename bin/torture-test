#!/bin/bash
#
# script meant to test out functinality of ScaleIO Cinder Driver
#
# Supported Operations (as of Newton)
# - Create, delete, clone, attach, detach, manage, and unmanage volumes
# - Create, delete, manage, and unmanage volume snapshots
# - Create a volume from a snapshot
# - Copy an image to a volume
# - Copy a volume to an image
# - Extend a volume
# - Get volume statistics
# - Create, list, update, and delete consistency groups
# - Create, list, update, and delete consistency group snapshots


# Volume Types
SIO_VOLUME_TYPE_THIN="ScaleIO-Thin"
SIO_VOLUME_TYPE_THICK="ScaleIO-Thick"


function show-volume-types {
  cinder type-list
}

function create-volume-types {

  # thin
  cinder --os-username admin --os-tenant-name admin type-create "${SIO_VOLUME_TYPE_THIN}"
  cinder --os-username admin --os-tenant-name admin type-key "${SIO_VOLUME_TYPE_THIN}" set volume_backend_name=scaleio provisioning:type=thin

  # thick
  cinder --os-username admin --os-tenant-name admin type-create "${SIO_VOLUME_TYPE_THICK}"
  cinder --os-username admin --os-tenant-name admin type-key "${SIO_VOLUME_TYPE_THICK}" set volume_backend_name=scaleio provisioning:type=thick

}

function delete-volume-types {

  # thin
  cinder --os-username admin --os-tenant-name admin type-delete "${SIO_VOLUME_TYPE_THIN}"
  # thick
  cinder --os-username admin --os-tenant-name admin type-delete "${SIO_VOLUME_TYPE_THICK}"

}






#
# mainline
#

create-volume-types
show-volume-types
delete-volume-types
